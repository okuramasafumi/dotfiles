# zshrc

# Load uitily function
autoload -Uz is-at-least

# Config directory
ZSH_DIR="$HOME/.zsh"

# Remove dups from paths
typeset -aU path cdpath fpath manpath

# Add some completions (we need this before compinit)
[ -e /opt/boxen/homebrew/share/zsh-completions ] && fpath=(/opt/boxen/homebrew/share/zsh-completions $fpath)
#[ -f /opt/boxen/homebrew/share/zsh/site-functions/git-completion.bash ] && source /opt/boxen/homebrew/share/zsh/site-functions/git-completion.bash

# The most important feature of zsh
autoload -Uz compinit
compinit

# cdr
if is-at-least 4.3.11; then
  autoload -Uz chpwd_recent_dirs cdr add-zsh-hook
  add-zsh-hook chpwd chpwd_recent_dirs
  zstyle ":chpwd:*" recent-dirs-max 500
  zstyle ":chpwd:*" recent-dirs-defalut true
  zstyle ":completion:*" recent-dirs-insert always
fi

# Boxen
[ -f /opt/boxen/env.sh ] && source /opt/boxen/env.sh
[ -f /opt/boxen/nvm/nvm.sh ] && source /opt/boxen/nvm/nvm.sh

# Antigen
if [[ -f $ZSH_DIR/antigen/antigen.zsh ]]; then
  source $ZSH_DIR/antigen/antigen.zsh

  antigen use oh-my-zsh

  antigen bundle git
  antigen bundle git-flow
  antigen bundle rails
  antigen bundle mollifier/anyframe
  antigen theme simple

  antigen apply
fi

# My aliases
source $ZSH_DIR/aliases.zsh

# Environment variables
source $ZSH_DIR/exports.zsh

# Anyframe
bindkey "^X'" anyframe-widget-cdr
bindkey "^Xh" anyframe-widget-put-history
bindkey "^Xt" anyframe-widget-tmux-attach
bindkey "^Xb" anyframe-widget-checkout-git-branch

# direnv
eval "$(direnv hook zsh)"

# Reload path to remove dups
path=($path)
